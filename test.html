<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Admin Dashboard</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- <link rel="stylesheet" href="../admin/admin.css" /> -->
    <!-- <script src="../admin/admin.js"></script> -->
    <style>
      .admin_part_hidden {
        display: none;
      }
      .mt-20 {
        margin-top: 20px;
      }
    </style>
  </head>
  <body>
    <div class="container mt-4">
      <h2>Admin Dashboard</h2>

      <!-- Buttons -->
      <div class="mb-4">
        <button id="btnClaimApproval" class="btn btn-primary me-2">Claim Approval</button>
        <button id="btnRoleAssign" class="btn btn-secondary me-2">Role Assign</button>
        <button id="btnClaimList" class="btn btn-info me-2">Claim List</button>
        <button id="btnRenewalList" class="btn btn-warning">Renewal List</button>
      </div>

      <!-- Claim Approval Section -->
      <div id="claimApprovalSection" class="admin_part_hidden">
        <h4>Policy Claims</h4>
        <table class="table table-bordered">
          <thead>
            <tr>
              <th>S.No.</th>
              <th>Claim ID</th>
              <th>Policy ID</th>
              <th>Amount</th>
              <th>Date</th>
              <th>Status</th>
              <th>Action</th>
              <th>Remark</th>
              <th>Submit</th>
            </tr>
          </thead>
          <tbody id="claimTableBody">
            <!-- Dynamic rows -->
          </tbody>
        </table>
      </div>

      <!-- Role Assign Section -->
      <div id="roleAssignSection" class="admin_part_hidden">
        <h4>Agent Roles</h4>
        <table id="agentTable" class="table table-bordered">
          <thead>
            <tr>
              <th>S.No.</th>
              <th>Name</th>
              <th>Role</th>
              <th>District</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <!-- Dynamic rows -->
          </tbody>
        </table>

        <button id="btnAddAgentForm" class="btn btn-success">Add Agent</button>

        <!-- Add/Edit Agent Form -->
        <div id="addAgentForm" class="mt-20 admin_part_hidden">
          <h5 id="formTitle">Add New Agent</h5>
          <div class="mb-2">
            <input type="text" id="agentName" class="form-control" placeholder="Name" />
          </div>
          <div class="mb-2">
            <label>Role:</label>
            <select id="agentRole" class="form-select">
              <option value="Agent">Agent</option>
              <option value="Manager">Manager</option>
            </select>
          </div>
          <div class="mb-2">
            <label>Select District(s):</label>
            <select id="agentDistricts" class="form-select" multiple>
              <option>Hyderabad</option>
              <option>Warangal</option>
              <option>Nizamabad</option>
              <option>Karimnagar</option>
              <option>Khammam</option>
            </select>
          </div>
          <button id="btnAddAgent" class="btn btn-primary">Add</button>
        </div>
      </div>

      <!-- Claim List Section -->
      <div id="claimListSection" class="admin_part_hidden">
        <h4>All Claims</h4>
        <table class="table table-bordered">
          <thead>
            <tr>
              <th>ID</th>
              <th>Name</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody id="claimListTableBody">
            <!-- Dynamic rows -->
          </tbody>
        </table>
      </div>

      <!-- Renewal List Section -->
      <div id="renewalListSection" class="admin_part_hidden">
        <h4>Renewals</h4>
        <table class="table table-bordered">
          <thead>
            <tr>
              <th>ID</th>
              <th>Name</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody id="renewalListTableBody">
            <!-- Dynamic rows -->
          </tbody>
        </table>
      </div>
    </div>

    <script>
      let editIndex = -1;
      const user_mode = "Admin"; // change this to "Agent" to test role-based visibility

      const claimList = [
        {
          claimId: "CL001",
          policyId: "POL123",
          amount: "₹50,000",
          date: "2025-07-15",
          status: "Pending",
        },
        {
          claimId: "CL002",
          policyId: "POL456",
          amount: "₹70,000",
          date: "2025-07-18",
          status: "Pending",
        },
        {
          claimId: "CL003",
          policyId: "POL789",
          amount: "₹35,000",
          date: "2025-07-20",
          status: "Pending",
        },
      ];

      $(document).ready(function () {
        if (user_mode === "Agent") {
          $("#btnRoleAssign").hide();
        }

        $("#btnClaimApproval").click(function () {
          $("#claimApprovalSection").removeClass("admin_part_hidden");
          $("#roleAssignSection").addClass("admin_part_hidden");
          renderClaims();
        });

        $("#btnRoleAssign").click(function () {
          $("#roleAssignSection").removeClass("admin_part_hidden");
          $("#claimApprovalSection").addClass("admin_part_hidden");
        });

        $("#btnAddAgentForm").click(function () {
          resetForm();
          $("#addAgentForm").toggleClass("admin_part_hidden");
        });

        $("#btnAddAgent").click(function () {
          const name = $("#agentName").val();
          const role = $("#agentRole").val();
          const districts = $("#agentDistricts").val();

          if (!name || !role || districts.length === 0) {
            alert("Please fill all fields");
            return;
          }

          const districtText = districts.join(", ");

          if (editIndex === -1) {
            const rowCount = $("#agentTable tbody tr").length + 1;
            const newRow = `
            <tr>
              <td>${rowCount}</td>
              <td>${name}</td>
              <td>${role}</td>
              <td>${districtText}</td>
              <td>
                <button class="btn btn-sm btn-warning editBtn">Edit</button>
                <button class="btn btn-sm btn-danger deleteBtn">Delete</button>
              </td>
            </tr>`;
            $("#agentTable tbody").append(newRow);
          } else {
            const row = $("#agentTable tbody tr").eq(editIndex);
            row.find("td").eq(1).text(name);
            row.find("td").eq(2).text(role);
            row.find("td").eq(3).text(districtText);
            editIndex = -1;
          }

          resetForm();
          $("#addAgentForm").addClass("admin_part_hidden");
        });

        $("#agentTable").on("click", ".editBtn", function () {
          const row = $(this).closest("tr");
          editIndex = row.index();
          const name = row.find("td").eq(1).text();
          const role = row.find("td").eq(2).text();
          const districts = row
            .find("td")
            .eq(3)
            .text()
            .split(",")
            .map((d) => d.trim());

          $("#agentName").val(name);
          $("#agentRole").val(role);
          $("#agentDistricts").val(districts);
          $("#formTitle").text("Edit Agent");
          $("#btnAddAgent").text("Update");
          $("#addAgentForm").removeClass("admin_part_hidden");
        });

        $("#agentTable").on("click", ".deleteBtn", function () {
          $(this).closest("tr").remove();
          renumberAgents();
        });

        $("#claimApprovalSection").on("click", ".submitClaimBtn", function () {
          const row = $(this).closest("tr");
          const action = row.find(".actionSelect").val();

          if (!action) {
            alert("Please select an action before submitting.");
            return;
          }

          row.find("td").eq(5).text("Completed"); // status column
          row.find(".actionSelect").prop("disabled", true);
          $(this).prop("disabled", true);
        });

        function resetForm() {
          $("#agentName").val("");
          $("#agentRole").val("Agent");
          $("#agentDistricts").val([]);
          $("#formTitle").text("Add New Agent");
          $("#btnAddAgent").text("Add");
          editIndex = -1;
        }

        function renumberAgents() {
          $("#agentTable tbody tr").each(function (index) {
            $(this)
              .find("td")
              .eq(0)
              .text(index + 1);
          });
        }

        function renderClaims() {
          $("#claimTableBody").empty();
          $.each(claimList, function (i, claim) {
            const row = `
            <tr>
              <td>${i + 1}</td>
              <td>${claim.claimId}</td>
              <td>${claim.policyId}</td>
              <td>${claim.amount}</td>
              <td>${claim.date}</td>
              <td>${claim.status}</td>
              <td>
                <select class="form-select actionSelect">
                  <option value="">Select</option>
                  <option value="Accept">Accept</option>
                  <option value="Reject">Reject</option>
                </select>
              </td>
              <td>
                <input type="text" class="form-control" placeholder="Enter remark" />
              </td>
              <td>
                <button class="btn btn-sm btn-success submitClaimBtn">Submit</button>
              </td>
            </tr>`;
            $("#claimTableBody").append(row);
          });
        }
      });

      const claimListData = [
  { id: 1, name: "Rajesh", status: "Approved" },
  { id: 2, name: "Neha", status: "Pending" },
  { id: 3, name: "Aarav", status: "Rejected" }
];

const renewalListData = [
  { id: 101, name: "Sahana", status: "Submitted" },
  { id: 102, name: "Vivek", status: "Completed" },
  { id: 103, name: "Divya", status: "Under Review" }
];

function showOnlySection(sectionId) {
  $("#claimApprovalSection, #roleAssignSection, #claimListSection, #renewalListSection")
    .addClass("admin_part_hidden");
  $(sectionId).removeClass("admin_part_hidden");
}

function renderSimpleTable(data, targetBody) {
  $(targetBody).empty();
  $.each(data, function (index, item) {
    $(targetBody).append(`
      <tr>
        <td>${item.id}</td>
        <td>${item.name}</td>
        <td>${item.status}</td>
      </tr>
    `);
  });
}

// Claim List Button
$("#btnClaimList").click(function () {
  showOnlySection("#claimListSection");
  renderSimpleTable(claimListData, "#claimListTableBody");
});

// Renewal List Button
$("#btnRenewalList").click(function () {
  showOnlySection("#renewalListSection");
  renderSimpleTable(renewalListData, "#renewalListTableBody");
});
    </script>
  </body>
</html>
